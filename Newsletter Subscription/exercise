Newsletter Subscription
Effort: Hard
Deadline: 16h
Difficulties/learning points:

Email
Transactions
Campaigns
Promotions
Coupons
Templates
Forms
Custom Objects
Objective:

Create a form for a Newsletter. Create a campaign based on coupons (type: System-generated codes coupons) that offers $20 off to each order. 

Each time a user subscribes to the newsletter and his email is saved in the CO, assign a new coupon code to him and save it in the CO. 

Also send an email to the customer with the coupon code. 



Restrictions:

It must not be allowed for the same email be used twice. 
If no coupon code is available anymore, send an email apologizing to the user
If you modify or create a site preference or custom object, you must update the corresponding metadata file in the repo.
Final Result:









HINTS

You need to understand how to use Transactions to make the whole exercise work (Check JavascriptControllers Guide)
Store the from email in Site Preferences and retrieve it from there
Use getNextCouponCode() the method in class Coupon, to generate the next unissued code of this coupon for the customer.


Research on http://search.osf.digital

new HashMap
new Mail
new Template
Resource.msg
require('dw/system/Site')
require('dw/object/CustomObjectMgr')
getCustomPreferenceValue
actionUrls
require('dw/system/Transaction')
require('*/cartridge/scripts/formErrors')
form toobject
getViewData